!function(e){function t(t){for(var i,r,a=t[0],l=t[1],c=t[2],p=0,h=[];p<a.length;p++)r=a[p],Object.prototype.hasOwnProperty.call(o,r)&&o[r]&&h.push(o[r][0]),o[r]=0;for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(e[i]=l[i]);for(d&&d(t);h.length;)h.shift()();return s.push.apply(s,c||[]),n()}function n(){for(var e,t=0;t<s.length;t++){for(var n=s[t],i=!0,a=1;a<n.length;a++){var l=n[a];0!==o[l]&&(i=!1)}i&&(s.splice(t--,1),e=r(r.s=n[0]))}return e}var i={},o={0:0},s=[];function r(t){if(i[t])return i[t].exports;var n=i[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=i,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="";var a=window.webpackJsonp=window.webpackJsonp||[],l=a.push.bind(a);a.push=t,a=a.slice();for(var c=0;c<a.length;c++)t(a[c]);var d=l;s.push([27,1]),n()}({14:function(e,t,n){},27:function(e,t,n){"use strict";n.r(t);n(13),n(14);var i=n(2),o=n(0),r=n.p+"nodes.json",a=n.p+"links.json",l=n.p+"triplets.json",c=n.p+"arial.xml",d=n.p+"arial.png",p=n(10),h=n.n(p),u=n(11),m=n(12),f=n.n(m);let w,x,g;const y=new o.TextStyle({font:"24px Arial",align:"center"});var v=()=>{const e=new o.Graphics;e.interactiveChildren=!1;const t=s.pixi.addChild(e);s.links.forEach(({source:e,target:n,value:i})=>{t.lineStyle(i,4473924),t.moveTo(e.x,e.y),t.lineTo(n.x,n.y)})};const b=12405313,C=13095362;var k=()=>{const e=new o.Graphics,t=(s.pixi.addChild(e),new o.TextStyle({font:"4px Arial",fill:b,align:"center"}));s.nodes.forEach(n=>{n.visibility=!1;const r=n.docs;n.circle=new o.Graphics,n.circle.beginFill(16777215,1),n.circle.drawCircle(0,0,r),n.circle.endFill(),n.circle.tint=C,n.circle.position=new o.Point(n.x,n.y),n.circle.interactive=!0,n.circle.hitArea=new o.Circle(0,0,s.distance),e.addChild(n.circle);const[a,l]=(e=>{const t=Math.round(e.length/2);for(let n=t,i=t;n<e.length||i>=0;n++,i--){if(" "===e[n])return[e.substring(0,n),e.substring(n+1)];if(" "===e[i])return[e.substring(0,i),e.substring(i+1)]}return[e,""]})(n.name);n.text=new o.BitmapText(`${a}\n${l}`,t),n.text.tint=C,n.text.position.set(n.x-n.text.width/2,n.y+r+2),e.addChild(n.text),n.circle.mouseover=e=>{!function(e){const t=i.select("body").append("div").attr("id","focus");t.append("h2").html(e.name),t.append("h3").html(e.docs+" Publications"),s.tokens=e.tokens.slice(0,3).map(e=>e.term),t.append("p").html("&nbsp;"),t.append("h3").html("Tokens by tf-idf"),t.append("p").html("—————————————"),e.tokens.forEach(e=>{const n='<span class="block"></span>'.repeat(e.tfidf);t.append("p").html(`${n} &nbsp; ${e.term}`)})}(n),s.nodes.filter(e=>n.peers.includes(e.id)).forEach(e=>{e.circle.tint=b,e.text.tint=b})},n.circle.mouseout=e=>{i.select("#focus").remove(),s.tokens=[],s.nodes.forEach(e=>{e.circle.tint=C,e.text.tint=C})}})};document.getElementsByTagName("body")[0];const T=new o.TextStyle({font:"4px Arial",align:"center"});window.d3=i,window.s={distance:40,links:v,nodes:k,tokens:[]},Promise.all([i.json(r),i.json(a),i.json(l),i.xml(c)]).then(([e,t,n,i])=>{s.links=t,s.nodes=e,s.triplets=n,console.log("nodes",s.nodes.length),console.log("links",s.links.length),console.log("triplets",s.triplets.length),(()=>{const e=new o.Application({width:window.innerWidth,height:window.innerHeight,antialias:!0,transparent:!0,resolution:2,autoDensity:!0,autoResize:!0,resizeTo:window});document.body.prepend(e.view),s.app=e;const t=new u.a({screenWidth:window.innerWidth,screenHeight:window.innerHeight,interaction:e.renderer.plugins.interaction});e.stage.addChild(t),s.pixi=t;t.drag().pinch().wheel().decelerate().clampZoom({minScale:.3,zoomMax:5}).setTransform(window.innerWidth/2,window.innerHeight/2,.3,.3);const n=d3.scaleLinear().domain([.3,2]).range([1,0]),i=d3.scaleLinear().domain([.3,2]).range([0,1]),r=d3.scaleLinear().domain([.3,2]).range([1,0]);t.on("zoomed",e=>{const t=e.viewport.lastViewport.scaleX;e.viewport.children[1].alpha=r(t),e.viewport.children[2].alpha=n(t),e.viewport.children[4].alpha=i(t)}),window.addEventListener("wheel",e=>{e.preventDefault()},{passive:!1})})();const r=o.Texture.from(d);o.BitmapText.registerFont(i,r);(()=>{const e=f()({every:1});setInterval(()=>{e.tick()},1e3/60);const t=document.getElementById("fps");e.on("data",(function(e){t.innerHTML=Math.floor(parseInt(e))}))})(),v(),(()=>{const e=new o.Graphics;e.interactiveChildren=!1;const t=s.pixi.addChild(e),n=d3.extent(s.nodes,e=>e.x),i=d3.extent(s.nodes,e=>e.y),r=n[1]-n[0],a=i[1]-i[0],l=n[0],c=i[0],d=d3.contourDensity().x(e=>e.x-l).y(e=>e.y-c).weight(e=>e.relevancy).size([r,a]).cellSize(15).bandwidth(50).thresholds(20)(s.nodes);d.forEach(e=>e.coordinates=e.coordinates.map(e=>e.map(e=>e.map(e=>[e[0]+l,e[1]+c]))));const p=3/d.length;let h=1;for(let e=d.length-1;e>=0;e--){const n=3-p*h;t.lineStyle(n,12405313),h+=1,d[e].coordinates.forEach(e=>{e.forEach(e=>{e.forEach(([e,n],i)=>{0==i&&t.moveTo(e,n),t.lineTo(e,n)})}),t.closePath()})}})(),(()=>{const e=new o.Graphics;e.interactiveChildren=!1,w=s.pixi.addChild(e);x=Math.pow(2*s.distance-2,2),g=Math.pow(2*s.distance+2,2),s.links.forEach(e=>{const t=Math.abs(e.source.x-e.target.x),n=Math.abs(e.source.y-e.target.y),i=Math.pow(t,2)+Math.pow(n,2);if(x<i&&i<g){const[i,r]=Object.entries(e.tokens)[0],a=.09*r,l=t/2+Math.min(e.source.x,e.target.x),c=n/2+Math.min(e.source.y,e.target.y);e.txt=new o.BitmapText(i,y),e.txt.tint=13095362,e.txt.scale.set(a),e.txt.position.set(l-e.txt.width/2,c-e.txt.height/2);let d=!1;s.links.filter(e=>e.txt).forEach(t=>{if(e.index==t.index)return;const n=e.txt,i=t.txt;i.x>n.x+n.width||i.x+i.width<n.x||i.y>n.y+n.height||i.y+i.height<n.y||(d=!0)}),d||w.addChild(e.txt)}})})(),k(),(()=>{const e=new o.Graphics;e.alpha=0,e.interactiveChildren=!1;const t=s.pixi.addChild(e);Math.pow(2*s.distance-2,2),Math.pow(2*s.distance+2,2);s.triplets.forEach(e=>{const n=e.tokens.slice(0,3),i=6*n.length/2,s=e.position[0],r=e.position[1];n.forEach(([e,n],a)=>{const l=new o.BitmapText(e,T);l.tint=6516064,l.scale.set(1.4),l.position.set(s-l.width/2,r-i+6*a),t.addChild(l)})})})(),(()=>{document.querySelector("#autoComplete").addEventListener("autoComplete",e=>{console.log(e)});new h.a({data:{src:async()=>s.nodes.reduce((e,{name:t,x:n,y:i})=>(e.push({name:t,x:n,y:i}),e),[]),key:["name"],cache:!1},sort:(e,t)=>e.match<t.match?-1:e.match>t.match?1:0,placeHolder:"Search",selector:"#autoComplete",threshold:0,debounce:0,searchEngine:"loose",highlight:!0,maxResults:10,resultsList:{render:!0,container:e=>{e.setAttribute("id","autoComplete_list")},destination:document.querySelector("#autoComplete"),position:"afterend",element:"ul"},resultItem:{content:(e,t)=>{t.innerHTML=e.match},element:"li"},noResults:()=>{const e=document.createElement("li");e.setAttribute("class","no_result"),e.setAttribute("tabindex","1"),e.innerHTML="No Results",document.querySelector("#autoComplete_list").appendChild(e)},onSelection:e=>{console.log(e);e.selection.key;const t=e.selection.value,{x:n,y:i,name:o}=t;document.querySelector("#autoComplete").value=o;s.pixi.setTransform(window.innerWidth/2-5*n,window.innerHeight/2-5*i,5,5);const r=d3.scaleLinear().domain([.3,5]).range([0,1]);s.pixi.children[1].alpha=0,s.pixi.children[2].alpha=0,s.pixi.children[4].alpha=r(5)}})})(),window.onresize=function(){s.pixi.resize()}})}});